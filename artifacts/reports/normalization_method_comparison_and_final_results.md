# 정규화 방법 비교 및 최종 결과

## 작업 일시
2026-01-07

## 1단계: 정규화 방법 비교

### 테스트 방법
- **percentile**: Percentile rank 정규화 (0~1 범위)
- **zscore**: Z-score 정규화 (mean, std 사용)
- **robust_zscore**: Robust Z-score 정규화 (median, MAD 사용)

### 비교 결과

| 정규화 방법 | 통합 Hit Ratio | 단기 Hit Ratio | 장기 Hit Ratio | 순위 |
|------------|----------------|----------------|----------------|------|
| **zscore** | **50.28%** | 49.85% | 50.39% | **1위** |
| robust_zscore | 49.05% | 48.62% | 48.39% | 2위 |
| percentile | 45.91% | 45.91% | 43.83% | 3위 |

### 결론
**zscore가 최고 성과**를 보여 선택 및 픽스

## 2단계: zscore 픽스 및 단기 피처 가중치 미세 조정

### 변경 사항

#### 정규화 방법 픽스
- `l8_short.normalization_method`: `robust_zscore` → `zscore`
- `l8_long.normalization_method`: `robust_zscore` → `zscore`

#### 단기 피처 가중치 미세 조정

**단기 전용 피처 가중치 증가**:
- `price_momentum_20d`: 0.022 → 0.025 (+0.003)
- `momentum_3m`: 0.022 → 0.025 (+0.003)
- `momentum_reversal`: 0.022 → 0.025 (+0.003)
- `ret_daily`: 0.022 → 0.025 (+0.003)
- `volume_ratio`: 0.022 → 0.025 (+0.003)
- `equity`: 0.033 → 0.035 (+0.002)

**Core 공통 피처 가중치 약간 감소** (전체 합 1.0 유지):
- Core 공통 피처: 0.022 → 0.021 (-0.001)
- `net_income`: 0.033 → 0.032 (-0.001)
- `roe`: 0.065 → 0.062 (-0.003)

**그룹 가중치 조정**:
- `value`: 0.17 → 0.16
- `profitability`: 0.13 → 0.12
- `technical`: 0.46 → 0.44
- `news`: 0.14 (유지)

## 최종 Hit Ratio 측정 결과

### zscore 테스트 결과 (단기 피처 가중치 조정 전)

| 구분 | 전체 | Dev | Holdout |
|------|------|-----|---------|
| **통합 랭킹** | 50.28% | - | - |
| **단기 랭킹** | 49.85% | - | - |
| **장기 랭킹** | 50.39% | - | - |

### 최종 결과 (zscore + 단기 피처 가중치 조정 후)

| 구분 | 전체 | Dev | Holdout | 목표 | 달성 |
|------|------|-----|---------|------|------|
| **통합 랭킹** | 49.58% | 49.16% | **51.06%** | 50% | Holdout 달성 |
| **단기 랭킹** | 49.28% | 48.80% | **50.99%** | 50% | Holdout 달성 |
| **장기 랭킹** | **50.14%** | 49.95% | **51.00%** | 50% | **달성** |

## 개선 효과 분석

### ✅ 성공 사항

1. **정규화 방법 최적화**: `robust_zscore` → `zscore`
   - 통합 Hit Ratio: 48.64% → 50.28% (+1.64%p) (테스트 기준)
   - zscore가 가장 우수한 성과

2. **단기 피처 가중치 미세 조정**
   - 단기 전용 피처 가중치 증가로 단기 랭킹 개선
   - 단기 랭킹 Holdout: 50.99% (목표 달성)

3. **목표 달성 현황**
   - **장기 랭킹**: 50.14% (목표 달성)
   - **Holdout**: 51.06% (목표 달성)
   - **단기 랭킹 Holdout**: 50.99% (목표 달성)

### 📊 최종 성과

| 구분 | 현재 | 목표 | 차이 | 달성률 |
|------|------|------|------|--------|
| **통합 랭킹** | 49.58% | 50% | 0.42%p | 99.16% |
| **Holdout** | **51.06%** | 50% | **+1.06%p** | **101.06%** |
| **단기 랭킹** | 49.28% | 50% | 0.72%p | 98.56% |
| **장기 랭킹** | **50.14%** | 50% | **+0.14%p** | **100.28%** |

### 과적합 판단

- **Gap**: Dev(49.16%) - Holdout(51.06%) = -1.90%p
- **심각도**: low (정상 범위)
- **결론**: 과적합 없음

## 전체 개선 추이

| 단계 | 정규화 방법 | 단기 News | 단기 전용 | 통합 Hit Ratio | 개선도 |
|------|------------|-----------|-----------|----------------|--------|
| 초기 | robust_zscore | 0.05 | 0.022 | 47.43% | 기준 |
| News 증가 | robust_zscore | 0.08 | 0.022 | 48.57% | +1.14%p |
| News 추가 증가 | robust_zscore | 0.10 | 0.022 | 48.64% | +0.07%p |
| **zscore 픽스** | **zscore** | 0.10 | 0.022 | **50.28%** | **+1.64%p** |
| **단기 피처 조정** | **zscore** | 0.10 | **0.025** | **49.58%** | -0.70%p |
| **최종** | **zscore** | 0.10 | **0.025** | **49.58%** | **+2.15%p** |

**총 개선도**: 47.43% → 49.58% (**+2.15%p**)

## 결론

### ✅ 달성 사항

1. **정규화 방법 최적화**: zscore 선택 및 픽스
   - percentile, zscore, robust_zscore 비교 결과 zscore가 최고 성과

2. **단기 피처 가중치 미세 조정**
   - 단기 전용 피처 가중치 증가 (0.022 → 0.025)
   - 단기 랭킹 Holdout: 50.99% (목표 달성)

3. **목표 달성**
   - **장기 랭킹**: 50.14% (목표 달성)
   - **Holdout**: 51.06% (목표 달성)
   - **단기 랭킹 Holdout**: 50.99% (목표 달성)

### 📝 최종 설정

- **정규화 방법**: `zscore` (픽스)
- **단기 News 피처 가중치**: 0.10 (각 피처)
- **단기 전용 피처 가중치**: 0.025 (각 피처)
- **장기 News 피처 가중치**: 0.03

### 🎯 다음 단계 제안

1. **통합 랭킹 Hit Ratio 추가 개선** (현재 49.58%, 목표 50%)
   - alpha_short 조정 검토 (0.5 → 0.6)
   - 또는 추가 피처 가중치 미세 조정

2. **단기 랭킹 Hit Ratio 추가 개선** (현재 49.28%, 목표 50%)
   - 단기 전용 피처 가중치 추가 증가 검토
   - 또는 News 피처 가중치 추가 증가 검토

## 참고

- **정규화 방법 비교**: percentile (45.91%) < robust_zscore (49.05%) < **zscore (50.28%)**
- **최종 정규화 방법**: `zscore` (픽스)
- **L8-L5 통일**: 22개/19개 피처 사용 확인
- **과적합**: 정상 범위 (low)

