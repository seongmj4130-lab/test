# 랭킹산정모델 개별 Hit Ratio 분석 리포트

**생성일시**: 2025-01-XX
**측정 스크립트**: `scripts/measure_ranking_hit_ratio.py`

---

## 📊 Hit Ratio 측정 기준

### 단기 랭킹
- **예측 스코어**: `score_total_short` (단기 피처셋 기반 랭킹)
- **실제 수익률**: `true_short` (20일 선행 수익률, `ret_fwd_20d`)
- **측정 방법**: 예측 방향(양수/음수)과 실제 수익률 방향 일치 비율

### 장기 랭킹
- **예측 스코어**: `score_total_long` (장기 피처셋 기반 랭킹)
- **실제 수익률**: `true_long` (120일 선행 수익률, `ret_fwd_120d`)
- **측정 방법**: 예측 방향(양수/음수)과 실제 수익률 방향 일치 비율

### 통합 랭킹
- **예측 스코어**: `score_ens` (단기/장기 랭킹 결합, α=0.5:0.5)
- **실제 수익률**: `true_short` (20일 선행 수익률)
- **측정 방법**: 예측 방향(양수/음수)과 실제 수익률 방향 일치 비율

---

## 📈 측정 결과

### 전체 Hit Ratio 비교

| 랭킹 유형 | 전체 Hit Ratio | Dev | Holdout | 샘플 수 | 목표 대비 |
|-----------|----------------|-----|---------|---------|-----------|
| **단기** | **41.58%** | 41.16% | 43.08% | 20,921 | ✗ -8.42%p |
| **장기** | **38.72%** | 38.13% | 41.45% | 19,449 | ✗ -11.28%p |
| **통합** | **41.58%** | 41.16% | 43.08% | 20,921 | ✗ -8.42%p |

**목표**: Hit Ratio ≥ 50%

---

## 🔍 주요 발견

### 1. 단기 랭킹이 장기 랭킹보다 우수

- **단기**: 41.58% (Dev 41.16%, Holdout 43.08%)
- **장기**: 38.72% (Dev 38.13%, Holdout 41.45%)
- **차이**: +2.86%p (단기가 장기보다 높음)

**해석**:
- 단기(20일) 예측이 장기(120일) 예측보다 정확함
- 단기 피처셋이 장기 피처셋보다 예측력이 높음

### 2. 통합 랭킹이 단기 랭킹과 동일

- **통합**: 41.58% (단기와 동일)
- **단기**: 41.58%
- **장기**: 38.72%

**해석**:
- 통합 랭킹의 Hit Ratio가 단기 랭킹과 정확히 동일함
- 장기 랭킹의 기여도가 낮거나 무시되고 있음
- 현재 결합 방식(α=0.5:0.5)이 최적이 아닐 수 있음

### 3. Holdout 성과가 Dev보다 높음 (모든 랭킹)

| 랭킹 유형 | Dev | Holdout | Gap |
|-----------|-----|---------|-----|
| 단기 | 41.16% | 43.08% | -1.92%p |
| 장기 | 38.13% | 41.45% | -3.32%p |
| 통합 | 41.16% | 43.08% | -1.92%p |

**해석**:
- ✅ 과적합 없음: Holdout 성과가 Dev보다 높아 일반화 성능 양호
- 장기 랭킹의 Gap이 더 큼 (-3.32%p)

---

## 🎯 개선 방안

### 1. 장기 랭킹 품질 개선 (우선순위 높음)

**현재**: 38.72% (목표 대비 -11.28%p)

**개선 방안**:
- 장기 피처셋 재검토 및 최적화
- 장기 전용 피처 추가 (120일 모멘텀, 장기 트렌드 등)
- 장기 랭킹 모델 파라미터 튜닝

### 2. 통합 랭킹 결합 가중치 최적화

**현재**: α=0.5:0.5 (단기와 동일한 결과)

**개선 방안**:
- 단기 가중치 증가: α=0.6~0.7 (단기 성과가 더 좋으므로)
- 시장 국면별 동적 가중치 (이미 적용 중, 추가 튜닝 필요)
- 성과 기반 적응형 가중치

### 3. 단기 랭킹 추가 개선

**현재**: 41.58% (목표 대비 -8.42%p)

**개선 방안**:
- 단기 피처셋 최적화
- 단기 전용 모델 파라미터 튜닝
- 단기 랭킹 품질 향상으로 통합 랭킹 성과 개선

---

## 📋 결합 가중치 분석

### 현재 설정

```yaml
l6r:
  alpha_short: 0.5  # 기본 가중치
  regime_alpha:
    bull_strong: 0.6
    bull_weak: 0.6
    neutral: 0.5
    bear_weak: 0.4
    bear_strong: 0.4
```

### 권장 조정

**이유**: 단기 랭킹(41.58%)이 장기 랭킹(38.72%)보다 우수하므로 단기 가중치를 높여야 함

```yaml
l6r:
  alpha_short: 0.6  # 0.5 → 0.6 (단기 가중치 증가)
  regime_alpha:
    bull_strong: 0.7  # Bull 시장에서 단기 더 강조
    bull_weak: 0.65
    neutral: 0.6
    bear_weak: 0.5
    bear_strong: 0.45
```

**예상 효과**: 통합 Hit Ratio +1~2%p 개선

---

## 📝 결론

### 현재 상태

1. ✅ **과적합 없음**: 모든 랭킹에서 Holdout 성과가 Dev보다 높음
2. ⚠️ **목표 미달**: 모든 랭킹이 목표(50%)보다 낮음
3. ✅ **단기 우수**: 단기 랭킹이 장기 랭킹보다 우수
4. ⚠️ **통합 비효율**: 통합 랭킹이 단기와 동일 (장기 기여도 낮음)

### 권장 사항

1. **즉시**: 통합 가중치 조정 (α=0.5 → 0.6)
2. **단기**: 장기 랭킹 품질 개선 (피처셋, 파라미터)
3. **중기**: 시장 국면별 가중치 추가 최적화

---

**생성 스크립트**: `scripts/measure_ranking_hit_ratio.py`
**결과 파일**: `artifacts/reports/ranking_hit_ratio_individual.csv`
