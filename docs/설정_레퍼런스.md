# 설정 레퍼런스 문서

이 문서는 프로젝트에서 사용되는 설정 파일의 구조와 각 파라미터에 대한 상세한 설명을 제공합니다.

## 목차

1. [설정 파일 구조](#설정-파일-구조)
2. [글로벌 파라미터](#글로벌-파라미터)
3. [백테스트 설정](#백테스트-설정)
4. [피처 엔지니어링 설정](#피처-엔지니어링-설정)
5. [모델링 설정](#모델링-설정)
6. [랭킹 설정](#랭킹-설정)
7. [환경변수 지원](#환경변수-지원)

## 설정 파일 구조

설정 파일은 YAML 형식을 사용하며, 다음과 같은 최상위 섹션으로 구성됩니다:

```yaml
# 글로벌 파라미터
params:
  start_date: "2016-01-01"
  end_date: "2024-12-31"

# 백테스트 설정
l7:
  cost_bps: 10.0
  holding_days: 20
  top_k: 12
  rebalance_interval: 1
  target_volatility: 0.15

# 피처 엔지니어링
l3:
  filter_k200_members_only: true

# 모델링 설정
l5:
  model_type: ensemble
  alpha: 0.01

# 랭킹 설정
l8:
  normalization_method: zscore
```

## 글로벌 파라미터

### params 섹션

| 키 | 타입 | 기본값 | 범위 | 설명 |
|----|------|--------|------|------|
| `start_date` | string | "2016-01-01" | - | 백테스트 시작 날짜 (YYYY-MM-DD) |
| `end_date` | string | "2024-12-31" | - | 백테스트 종료 날짜 (YYYY-MM-DD) |

**예시:**
```yaml
params:
  start_date: "2016-01-01"
  end_date: "2024-12-31"
```

## 백테스트 설정

### l7 섹션 (주요 백테스트 파라미터)

| 키 | 타입 | 기본값 | 범위 | 설명 |
|----|------|--------|------|------|
| `cost_bps` | number | 10.0 | 0-100 | 거래 비용 (기준점) |
| `holding_days` | integer | 20 | 1-365 | 포지션 유지 기간 (일) |
| `top_k` | integer | 12 | 1-50 | 상위 K개 종목 선택 |
| `rebalance_interval` | integer | 1 | 1-100 | 리밸런싱 주기 (일) |
| `target_volatility` | number | 0.15 | 0.01-1.0 | 목표 변동성 |

**예시:**
```yaml
l7:
  cost_bps: 10.0
  holding_days: 20
  top_k: 12
  rebalance_interval: 1
  target_volatility: 0.15
```

### 전략별 설정

#### bt20_short (단기 모멘텀 전략)

```yaml
bt20_short:
  holding_days: [20, 40, 60]
  top_k: 8
  cost_bps: 8
  buffer_k: 10
  rebalance_interval: 15
  target_vol: 0.18
```

#### bt120_long (장기 트렌드 전략)

```yaml
bt120_long:
  holding_days: [120]
  top_k: 12
  cost_bps: 12
  buffer_k: 18
  rebalance_interval: 25
  target_vol: 0.12
  tranche_holding_days: 120
  tranche_max_active: 4
```

#### bt20_ens (통합 전략)

```yaml
bt20_ens:
  holding_days: [40, 60]
  top_k: 6
  cost_bps: 6
  buffer_k: 12
  rebalance_interval: 20
  target_vol: 0.14
```

## 피처 엔지니어링 설정

### l3 섹션

| 키 | 타입 | 기본값 | 설명 |
|----|------|--------|------|
| `filter_k200_members_only` | boolean | true | KOSPI200 종목만 필터링 |
| `fundamentals_effective_date_col` | string | effective_date | 펀더멘털 데이터 날짜 컬럼 |

### l4 섹션 (데이터 분할)

| 키 | 타입 | 기본값 | 범위 | 설명 |
|----|------|--------|------|------|
| `embargo_days` | integer | 20 | 0-365 | 임베르고 기간 (일) |
| `holdout_years` | integer | 2 | 1-10 | 홀드아웃 기간 (년) |
| `inner_cv_k` | integer | 5 | 2-10 | 내부 교차검증 폴드 수 |

## 모델링 설정

### l5 섹션

| 키 | 타입 | 기본값 | 범위 | 설명 |
|----|------|--------|------|------|
| `alpha` | number | 0.01 | 0.0001-10.0 | 정규화 파라미터 |
| `model_type` | string | ensemble | - | 모델 타입 (ridge, xgboost, ensemble) |
| `ridge_alpha` | number | 0.01 | 0.0001-10.0 | Ridge 회귀 alpha |
| `min_feature_ic` | number | -0.05 | -1.0-1.0 | 최소 피처 IC 임계값 |

**지원 모델 타입:**
- `ridge`: Ridge 회귀
- `xgboost`: XGBoost
- `ensemble`: 앙상블 모델

## 랭킹 설정

### l8 섹션

| 키 | 타입 | 기본값 | 설명 |
|----|------|--------|------|
| `normalization_method` | string | zscore | 정규화 방법 (zscore, minmax, robust) |
| `sector_col` | string | sector_name | 섹터 컬럼명 |
| `use_sector_relative` | boolean | true | 섹터 상대 랭킹 사용 |

**정규화 방법:**
- `zscore`: Z-점수 정규화
- `minmax`: 최소-최대 정규화
- `robust`: 로버스트 정규화 (이상치에 강함)

### 피처 가중치 설정

피처 가중치는 별도 파일에서 관리되며, 그룹별 가중치 구조를 가집니다:

```yaml
feature_weights:
  equity: 0.03
  total_liabilities: 0.03
  # ... 개별 피처 가중치

group_weights:
  value: 0.15
  profitability: 0.1
  technical: 0.6
  other: 0.1
  news: 0.05
```

## 환경변수 지원

설정 파일에서 환경변수를 사용할 수 있습니다:

```yaml
paths:
  base_dir: ${BASE_DIR}  # 또는 $BASE_DIR
  data_dir: ${DATA_DIR}/processed
```

**지원 형식:**
- `${VAR_NAME}`: 중괄호 형식 (권장)
- `$VAR_NAME`: 간단 형식

## 검증 규칙

설정 파일은 다음과 같은 검증 규칙을 따릅니다:

### 필수 키
- `params.start_date`
- `params.end_date`
- `l7.top_k`
- `l7.holding_days`
- `l7.cost_bps`

### 타입 검증
- 날짜: YYYY-MM-DD 형식
- 숫자 파라미터: 지정된 타입 준수

### 범위 검증
- `top_k`: 1-50
- `holding_days`: 1-365
- `cost_bps`: 0-100
- `rebalance_interval`: 1-100
- `target_volatility`: 0.01-1.0

## 관련 문서

- [설정 검증 사용법](설정_검증_사용법.md): 배치 검증 도구 사용법
- [PORTFOLIO_FINAL_REPORT.md](PORTFOLIO_FINAL_REPORT.md): 프로젝트 최종 보고서